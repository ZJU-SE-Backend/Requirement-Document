# 医院模糊查询

## 需求描述

### 需求介绍

前端向后端传递病人输入的医院搜索query，从数据库中查出能够模糊匹配的相关医院名称并返回满足要求的医院、位置

### API列表

| 请求类型 | PATH                            | 描述                        |
| -------- | ------------------------------- | --------------------------- |
| GET      | /api/appoinment/patient/{query} | 通过query查询近似匹配的医院 |

### GET  /api/appoinment/patient/{query} 医院模糊查询

Request

| Key   | Value  | Required | Description    |
| ----- | ------ | -------- | -------------- |
| query | string | y        | 用户输入的查询 |

#### Response

```json
{
  "st": 0,
  "msg": "",
  "data": {
    "hospitalList": [
      {
        "hospital": "杭州市中医院（丁桥院区）",
        "position": "杭州市江干区环丁路1630号"
      },
      {
        "hospital": "杭州市中医院（武林院区）",
        "position": "杭州市体育场路453号"
      },
      {
        "hospital": "杭州市儿童医院",
        "position": "杭州市下城区文晖路195号"
      }
    ]
  }
}
```



### 普通号挂号

设置了普通号医生，所有的普通号预约都记录在当前的这个医生下（电话00000000000）

需要对预约挂号、查询余量、删除预约记录三个函数进行修改

### GET /api/appointment/patient/appoint 预约查询

```
{
  "patientPhone": "13853603503",
  "doctorPhone": "00000000000",
  "appointDate": 1624406400,
  "section": 14,
  "room":"儿科子科室",
  "hospital":"杭州市第一人民医院"
}
```

这些参数中，room和hospital在普通号预约中会提供，在专家号中不会提供（由后端提供一个默认值，根据专家号医生所在的医院、科室信息填充）

### DELETE /api/appointment/patient/withdraw 预约删除

#### Request body

```
{
  "patientPhone": "string",
  "appointDate": 0,
  "section": 0,
  "room":"xxx科室",
  "hospital":"xxx医院"
}
```

在参数中，room和hospital专门为普通号预约提供的，用来在数据库中搜索到对应的普通号记录并进行删除

### GET /api/appointment/patient/appoint/doctor 查询医生对应预约数量

需要为普通号查询做出修改，除了医生电话、预约日期、预约时段之外，另外提供科室、医院信息，帮助搜索普通号下某科室的预约数量

| Key         | Value  | Required | Description                       |
| ----------- | ------ | -------- | --------------------------------- |
| doctorPhone | long   | y        | 预约医生电话，普通号为00000000000 |
| appointDate | long   | y        | 预约日期的UNIX时间戳              |
| section     | int    | y        | 预约时段                          |
| room        | string | n        | 预约的子科室                      |
| hospital    | string | n        | 预约的医院                        |

```
{
  "st": 0,
  "msg": "",
  "data": {
    "appointNum": 0
  }
}
```

说明：

预约时候使用的科室统一都是最底层的子科室